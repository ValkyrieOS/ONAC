<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Miembros ONAC</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap");
    </style>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ["Poppins", "sans-serif"],
            },
            colors: {
              "onac-blue": "#3B82F6",
              "onac-dark": "#1E293B",
              "onac-light": "#F3F4F6",
              "onac-orange": "#D97706",
            },
          },
        },
      };
    </script>
  </head>
  <body
    class="bg-gradient-to-br from-gray-900 to-onac-dark text-onac-light min-h-screen flex flex-col font-sans"
  >
    <header class="bg-gray-800 text-white py-6 sticky top-0 z-10 shadow-lg">
      <div class="container mx-auto px-4">
        <div class="flex justify-between items-center">
          <h1 class="text-3xl font-bold text-onac-blue">ONAC</h1>
          <nav>
            <ul class="flex space-x-6">
              <li>
                <a
                  href="index.html"
                  class="hover:text-onac-blue transition-colors duration-200 text-lg"
                  >Inicio</a
                >
              </li>
              <li>
                <a
                  href="clans.html"
                  class="hover:text-onac-blue transition-colors duration-200 text-lg"
                  >Clanes</a
                >
              </li>
              <li>
                <a
                  href="balance.html"
                  class="hover:text-onac-blue font-semibold transition-colors duration-200 text-lg"
                  >Balance</a
                >
              </li>
              <li>
                <a
                  href="pagos.html"
                  class="hover:text-onac-blue font-semibold transition-colors duration-200 text-lg"
                  >Pagos</a
                >
              </li>
              <li>
                <a
                  href="#"
                  class="hover:text-onac-blue transition-colors duration-200 text-lg"
                  >Miembros</a
                >
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </header>

    <main class="flex-grow container mx-auto px-4 py-6 md:py-8">
      <h2 class="text-2xl md:text-3xl font-semibold mb-6 text-onac-blue">
        Miembros ONAC
      </h2>
      <div
        class="mb-6 flex flex-col md:flex-row justify-between items-start md:items-center space-y-4 md:space-y-0"
      >
        <div class="flex flex-wrap gap-2 md:gap-4">
          <button
            id="filterAll"
            class="px-3 py-1 md:px-4 md:py-2 bg-onac-blue text-white rounded hover:bg-blue-600 transition-colors text-sm md:text-base"
          >
            Todos
          </button>
          <button
            id="filterJava"
            class="px-3 py-1 md:px-4 md:py-2 bg-gray-700 text-white rounded hover:bg-gray-600 transition-colors text-sm md:text-base"
          >
            Java
          </button>
          <button
            id="filterBedrock"
            class="px-3 py-1 md:px-4 md:py-2 bg-gray-700 text-white rounded hover:bg-gray-600 transition-colors text-sm md:text-base"
          >
            Bedrock
          </button>
        </div>
        <input
          type="text"
          id="searchInput"
          placeholder="Buscar miembros..."
          class="w-full md:w-auto px-3 py-1 md:px-4 md:py-2 bg-gray-700 text-white rounded focus:outline-none focus:ring-2 focus:ring-onac-blue text-sm md:text-base"
        />
      </div>
      <div
        id="membersList"
        class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 md:gap-6"
      >
        <!-- Los miembros se insertarán aquí -->
      </div>
    </main>

    <footer
      class="bg-gray-800 bg-opacity-50 backdrop-filter backdrop-blur-lg text-center py-4 border-t border-gray-700"
    >
      <p class="text-xs md:text-sm text-gray-400">
        © 2024 ONAC - Organización de NauticMC para la Ayuda y el Crecimiento
      </p>
    </footer>

    <script>
      async function fetchMembers() {
        try {
          const response = await fetch("data/members.json");
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          const data = await response.json();
          return data.members;
        } catch (error) {
          console.error("Error al cargar los miembros:", error);
          return [];
        }
      }

      function createMemberCard(member) {
        const card = document.createElement("div");
        card.className =
          "bg-gray-800 rounded-lg overflow-hidden shadow-lg transform transition-all duration-300 hover:scale-105";

        const rankColors = {
          OWNER: "bg-red-500",
          Líder: "bg-yellow-500",
          Miembro: "bg-green-500",
        };

        const platformIcon =
          member.platform === "java" ? "fa-brands fa-java" : "fa-solid fa-cube";
        const ownerIcon = member.isOwner
          ? `<i class="fas fa-crown text-yellow-500 ml-2" aria-label="Propietario"></i>`
          : "";

        card.innerHTML = `
                <div class="relative">
                    <img src="${member.image}" alt="${
          member.name
        }" class="w-full h-40 object-cover">
                    <div class="absolute top-2 right-2 bg-gray-900 bg-opacity-75 p-2 rounded-full">
                        <i class="${platformIcon} text-lg ${
          member.platform === "java" ? "text-orange-400" : "text-blue-400"
        }" aria-label="Plataforma: ${member.platform}"></i>
                    </div>
                </div>
                <div class="p-4">
                    <div class="flex justify-between items-start mb-2">
                        <div>
                            <h3 class="text-lg font-bold truncate">${
                              member.name
                            }</h3>
                            <p class="text-xs text-gray-400 truncate">${
                              member.clan
                            }</p>
                        </div>
                        <span class="inline-block px-2 py-1 text-xs font-semibold rounded-full ${
                          rankColors[member.rank] || "bg-gray-700"
                        } text-white" aria-label="Rango: ${member.rank}">${
          member.rank
        }</span>
                    </div>
                    <div class="flex items-center justify-between text-sm">
                        <p class="text-gray-400">
                            ${
                              member.platform.charAt(0).toUpperCase() +
                              member.platform.slice(1)
                            }
                        </p>
                        ${ownerIcon}
                    </div>
                </div>
            `;

        return card;
      }

      let allMembers = [];

      async function displayMembers(filter = "all") {
        const membersListContainer = document.getElementById("membersList");

        if (!membersListContainer) {
          console.error("No se encontró el contenedor de miembros");
          return;
        }

        membersListContainer.innerHTML = "";

        const filteredMembers = allMembers.filter((member) => {
          if (filter === "all") return true;
          return member.platform === filter;
        });

        filteredMembers.forEach((member) => {
          const card = createMemberCard(member);
          membersListContainer.appendChild(card);
        });
      }

      function setupEventListeners() {
        document
          .getElementById("filterAll")
          .addEventListener("click", () => displayMembers("all"));
        document
          .getElementById("filterJava")
          .addEventListener("click", () => displayMembers("java"));
        document
          .getElementById("filterBedrock")
          .addEventListener("click", () => displayMembers("bedrock"));

        const searchInput = document.getElementById("searchInput");
        searchInput.addEventListener("input", () => {
          const searchTerm = searchInput.value.toLowerCase();
          const filteredMembers = allMembers.filter(
            (member) =>
              member.name.toLowerCase().includes(searchTerm) ||
              member.clan.toLowerCase().includes(searchTerm)
          );
          displayFilteredMembers(filteredMembers);
        });
      }

      function displayFilteredMembers(members) {
        const membersListContainer = document.getElementById("membersList");
        membersListContainer.innerHTML = "";
        members.forEach((member) => {
          const card = createMemberCard(member);
          membersListContainer.appendChild(card);
        });
      }

      async function initializePage() {
        allMembers = await fetchMembers();
        displayMembers();
        setupEventListeners();
      }

      document.addEventListener("DOMContentLoaded", initializePage);
    </script>
  </body>
</html>
